!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.task=n()}}(function(){return function n(t,o,r){function u(e,f){if(!o[e]){if(!t[e]){var c="function"==typeof require&&require;if(!f&&c)return c(e,!0);if(i)return i(e,!0);var p=new Error("Cannot find module '"+e+"'");throw p.code="MODULE_NOT_FOUND",p}var a=o[e]={exports:{}};t[e][0].call(a.exports,function(n){var o=t[e][1][n];return u(o?o:n)},a,a.exports,n,t,o,r)}return o[e].exports}for(var i="function"==typeof require&&require,e=0;e<r.length;e++)u(r[e]);return u}({1:[function(require,n,exports){"use strict";var t=require("./task");n.exports=t},{"./task":2}],2:[function(require,n,exports){"use strict";function t(n,t){this.run=t?r(n):o(n)}function o(n){return function(t,o){return n(t,o)||i}}function r(n){return function(t,o){var r=!1,u=n(function(n){r||(r=!0,t(n))},function(n){r||(r=!0,o(n))});return function(){r||(r=!0,u&&u())}}}function u(n){return new t(n,!0)}function i(){}function e(n){return function(t){if(t&&"function"==typeof t[n])return t[n]()}}function f(n){return function t(o,r){return 1===arguments.length?p(t,o):r&&"function"==typeof r[n]?r[n](o):void 0}}function c(n){return function t(o,r,u){return 1===arguments.length?p(t,o):2===arguments.length?a(t,o,r):u&&"function"==typeof u[n]?u[n](o,r):void 0}}function p(n,t){return function(o,r,u){switch(arguments.length){case 1:return n(t,o);case 2:return n(t,o,r);default:return n(t,o,r,u)}}}function a(n,t,o){return function(r,u){return 1===arguments.length?n(t,o,r):n(t,o,r,u)}}t.prototype["@@type"]="jordalgo/task",t.prototype.map=function(n){var o=this.run;return new t(function(t,r){return o(t,function(t){r(n(t))})})},t.prototype.bimap=function(n,o){var r=this.run;return new t(function(t,u){return r(function(o){t(n(o))},function(n){u(o(n))})})},t.prototype.chain=function(n){var o=this.run;return new t(function(t,r){var u=void 0,i=o(t,function(o){u=n(o).run(t,r)});return function(){i(),u&&u()}})},t.prototype.bichain=function(n,o){var r=this.run;return new t(function(t,u){var i=void 0,e=r(function(o){i=n(o).run(t,u)},function(n){i=o(n).run(t,u)});return function(){e(),i&&i()}})},t.prototype.ap=function(n){var o=this.run;return new t(function(t,r){function u(n){i||(i=!0,t(n))}var i=void 0,e=void 0,f=void 0,c=void 0,p=n.run(u,function(n){e?r(c(n)):(e=!0,f=n)}),a=o(u,function(n){e?r(n(f)):(e=!0,c=n)});return function(){p(),a()}})},t.prototype.concat=function(n){var o=this.run;return new t(function(t,r){function u(n){e||(e=!0,t(n))}function i(n){e||(e=!0,r(n))}var e=void 0,f=n.run(u,i),c=o(u,i);return function(){f(),c()}})},t.prototype.cache=function(){var n=!1,o=!1,r=void 0,u=void 0,e=[],f=[],c=this.run;return new t(function(t,p){return n&&o?("fail"===o?t(r):p(u),i):n?(f.indexOf(t)===-1&&f.push(t),void(e.indexOf(p)===-1&&e.push(p))):(n=!0,e.push(p),f.push(t),c(function(n){o="fail",r=n,f.forEach(function(t){t(n)}),f=[]},function(n){o="success",u=n,e.forEach(function(t){t(n)}),e=[]}))})},t.prototype.of=function(n){return new t(function(t,o){o(n)})},t.prototype.fail=function(n){return new t(function(t){t(n)})},t.prototype.empty=function(){return new t(function(){})},t.prototype.toString=function(){return"Task"},u.chain=f("chain"),u.bichain=c("bichain"),u.map=f("map"),u.bimap=c("bimap"),u.ap=f("ap"),u.concat=f("concat"),u.cache=e("cache"),u.of=t.prototype.of,u.fail=t.prototype.fail,u.empty=t.prototype.empty,u.all=function(n){function o(){u=[],r=[],i=!0}var r=[],u=[],i=!1;return new t(function(t,e){n.forEach(function(f){var c=f.run(function(n){i||(u.forEach(function(n){n()}),t(n),o())},function(t){i||(r.push(t),r.length===n.length&&(e(r),o()))});return u.push(c),function(){u.forEach(function(n){n()})}})})},n.exports=u},{}]},{},[1])(1)});